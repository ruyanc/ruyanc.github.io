<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Personal Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="ruyanc">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="ruyanc">
<meta property="og:description" content="Personal Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ruyan">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>ruyanc</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ruyanc</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-atmsci">

    <a href="/categories/AtmSci/" rel="section"><i class="fa fa-archive fa-fw"></i>AtmSci</a>

  </li>
        <li class="menu-item menu-item-ocnsci">

    <a href="/categories/OcnSci/" rel="section"><i class="fa fa-archive fa-fw"></i>OcnSci</a>

  </li>
        <li class="menu-item menu-item-tools">

    <a href="/categories/Tools/" rel="section"><i class="fa fa-archive fa-fw"></i>Tools</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/01/Tools/Python_IO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruyan">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruyanc">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/01/Tools/Python_IO/" class="post-title-link" itemprop="url">Python IO</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-01 12:00:00" itemprop="dateCreated datePublished" datetime="2022-05-01T12:00:00+08:00">2022-05-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-23 12:00:00" itemprop="dateModified" datetime="2022-05-23T12:00:00+08:00">2022-05-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">-Tools</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/wqnT0TQMbHZ3rKqnQuqnJw">https://mp.weixin.qq.com/s/wqnT0TQMbHZ3rKqnQuqnJw</a></p>
<p><strong>1.Python自带方式</strong></p>
<p>  Python自带的文件打开函数是open及with open，使用方式为：</p>
<p>open函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f = open(file,’r’)f.read()f.close()</span><br></pre></td></tr></table></figure>



<p>  麻烦之处在于，每次用完文件后，要使用close()函数关闭文件，如果文件关闭的位置不合适或者忘记关闭文件，就会报错。</p>
<p>  with open函数是open函数的进阶版，优势在于不需要关闭文件，使用方式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">with open(file,’r’) as f:         f.read()</span><br></pre></td></tr></table></figure>



<p>  该函数会自动检测，在不使用文件的时候自动关闭，并不需要手动关闭文件。</p>
<p>  读取文件时，其读取方式的可选参数（即前文函数中’r’位置）与之前在MATLAB环节介绍过的一致，再掏出表格复习一遍：</p>
<table>
<thead>
<tr>
<th>打开模式</th>
<th>执行操作</th>
</tr>
</thead>
<tbody><tr>
<td>‘r’</td>
<td>以只读方式打开文件（默认）</td>
</tr>
<tr>
<td>‘w’</td>
<td>以写入的方式打开文件，会覆盖已存在的文件</td>
</tr>
<tr>
<td>‘x’</td>
<td>如果文件已经存在，使用此模式打开将引发异常</td>
</tr>
<tr>
<td>‘a’</td>
<td>以写入模式打开，如果文件存在，则在末尾追加写入</td>
</tr>
<tr>
<td>‘b’</td>
<td>以二进制模式打开文件</td>
</tr>
<tr>
<td>‘t’</td>
<td>以文本模式打开（默认）</td>
</tr>
<tr>
<td>‘+’</td>
<td>可读写模式（可添加到其他模式中使用）</td>
</tr>
<tr>
<td>‘U’</td>
<td>通用换行符支持</td>
</tr>
</tbody></table>
<p>  同之前例子，小明想以二进制的形式打开一个已存在的文件，在读入数据后，在文件中再持续写入数据，则查一查表中相对应的符号，他可以：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f = open(&#x27;write_data.txt&#x27;,&#x27;ab+&#x27;)</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">with open(&#x27;write_data.txt&#x27;,&#x27;ab+&#x27;) as f:</span><br></pre></td></tr></table></figure>



<p>在文件操作方面，open函数和with open函数是一致的 ，包含的文件操作函数有：</p>
<table>
<thead>
<tr>
<th>文件对象方法</th>
<th>执行操作</th>
</tr>
</thead>
<tbody><tr>
<td>f.close()</td>
<td>关闭文件</td>
</tr>
<tr>
<td>f.read([size&#x3D;-1])</td>
<td>从文件读取size个字符，当未给定size或给定负值的时候，读取剩余的所有字符，然后作为字符串返回</td>
</tr>
<tr>
<td>f.readline([size&#x3D;-1])</td>
<td>从文件中读取并返回一行（包括行结束符），如果有size有定义则返回size个字符</td>
</tr>
<tr>
<td>f.write(str)</td>
<td>将字符串str写入文件</td>
</tr>
<tr>
<td>f.writelines(seq)</td>
<td>向文件写入字符串序列seq，seq应该是一个返回字符串的可迭代对象</td>
</tr>
<tr>
<td>f.seek(offset, from)</td>
<td>在文件中移动文件指针，从from（0代表文件起始位置，1代表当前位置，2代表文件末尾）偏移offset个字节</td>
</tr>
<tr>
<td>f.tell()</td>
<td>返回当前在文件中的位置</td>
</tr>
<tr>
<td>f.truncate([size&#x3D;file.tell()])</td>
<td>截取文件到size个字节，默认是截取到文件指针当前位置</td>
</tr>
</tbody></table>
<p>  所以怎么写入文件也呼之欲出了，没错，就是f.write()函数或f.writelines()函数。格式控制和之前在MATLAB与NCL版块里介绍过的一致，就不在此重复了。</p>
<p>  虽然也能打开文件，但由于Python不支持数组格式，因此常对后续的数据计算过程造成阻碍，这时聪明的小伙伴就想到了自己写一个数组对象，于是numpy库就出现了。</p>
<p><strong>2.numpy</strong></p>
<p> numpy定义了一个array类型的数组，使用numpy.array(data)就可以轻松得到一个数组data，之后就可以方便地进行类似其他语言的数组操作啦！</p>
<p>  numpy库的文件打开效率虽然比不上后面两个pandas和xarray库，但比最原始的open一个文件然后再各种split挑选数据的方式要高效很多，其读取函数包括读取文件时的genformtxt、loadtxt、以及保存时所需的savetxt。</p>
<p>genformtxt的完整使用方式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.genfromtxt(fname, dtype=&lt;type &#x27;float&#x27;&gt;, comments=&#x27;#&#x27;, delimiter=None, skip_header=0, skip_footer=0, converters=None, missing_values=None, filling_values=None, usecols=None, names=None, excludelist=None, deletechars=None, replace_space=&#x27;_&#x27;, autostrip=False, case_sensitive=True, defaultfmt=&#x27;f%i&#x27;, unpack=None, usemask=False, loose=True, invalid_raise=True, max_rows=None)[source]¶</span><br></pre></td></tr></table></figure>

<p>当然平时的使用中大部分时候用不到这么多参数，平时多用的形式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.genfromtxt(fname, dtype=&lt;type &#x27;float&#x27;&gt;, delimiter=’’, skip_header=1)</span><br></pre></td></tr></table></figure>

<p>delimiter表示数据分隔符，skip_header表示跳过文件的前几行之后开始读取。</p>
<p>类似地，loadtxt的常用形式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.loadtxt(fname,dtype=,delimiter=None,skiprows=0)</span><br></pre></td></tr></table></figure>

<p> skiprows在这里表示跳过前几行，使用形式和genformtxt大体相同，只是有些参数的名称不同。</p>
<p>保存文件时用到savetxt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.savetxt(&quot;file.txt&quot;, a)</span><br></pre></td></tr></table></figure>



<p><strong>3.pandas</strong></p>
<p>  pandas的读取效率又要高于上述的numpy包，这部分得益于pandas常用的两种数据结构：Series和DataFrame，顾名思义，区别在于Series为一维数据，而DataFrame为两维数据。</p>
<p>读取文件时，pandas针对不同文件有不同的函数，具体可在下列官网中找到：</p>
<p><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html</a></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/I9yFeiacVauaiaae9AbA49yXs7Beia1kCUuguSNclYCgXHnF0RHlUBnrlmhnysygn15FoHiatQF3HGc2GT8BwiaCesw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p>截张不完全的图感受一下pandas针对读取和写入文件施工的函数数量。</p>
<p>因为函数实在太多，此处仅简单举例，例如使用read_table函数读入txt文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_table(&#x27;filename.txt&#x27;,sep=&#x27;\t&#x27;,header=2)</span><br></pre></td></tr></table></figure>

<p>此处sep表示数据分隔符，header表示跳过头文件的行数。</p>
<p><strong>4.xarray</strong></p>
<p>以上库在读取txt或csv等通用格式的数据时很好用，然而到了气象领域，面对多维数组和特殊的数据格式，以上函数多少都会显得力不从心，此时，xarray库就派上了用场。</p>
<p>xarray的数据类型主要包括DataArray、Dataset两类（其实和numpy的Series及DataFrame两种数据格式类似）。DataArray包含的属性有：values记录数组的具体数值、dims记录维度的名字、coords记录数据坐标、attrs记录数据的属性，比如变量的单位等。Dataset可以理解为由多个DataArray组成的数据结构，它包括：dims 记录维度的名字、data_vars记录各个变量的名字、coords 记录坐标、attrs 记录数据的属性，比变量的单位等。</p>
<p>在读取数据时，常使用的函数为open_dataset，此函数甚至可以直接读取气象中常用的nc格式数据，只需要：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds_disk = xr.open_dataset(&quot;saved_on_disk.nc&quot;)</span><br></pre></td></tr></table></figure>

<p>官方说明可参考：</p>
<p><a target="_blank" rel="noopener" href="http://xarray.pydata.org/en/stable/io.html">http://xarray.pydata.org/en/stable/io.html</a></p>
<p>6.其他</p>
<p>netCDF4 、UV-CDAT等库这些库也能达到省心省力读取气象格式数据的效果，有感兴趣的小伙伴可以参阅家园用户的分享：</p>
<p>18393810639针对netCDF4库的分享：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92817">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92817</a></p>
<p>风往北吹的UV-CDAT库介绍：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=48188">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=48188</a></p>
<p><strong>8.批量读取：os</strong></p>
<p>常有小伙伴头疼文件怎么批量读取，甚至为此建立数组写循环，拼出每个文件的名称再去读取。实际上，拥有了os模块，只需要使用listdir函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import osPaths = os.listdir(filepath)</span><br></pre></td></tr></table></figure>

<p>filepath文件夹下的所有文件名就被保存在paths变量中了，之后再结合for语句和之前介绍过的文件读取函数，循环读取paths中的每一行就可以了。简单又省心！</p>
<h4 id="read-NC"><a href="#read-NC" class="headerlink" title="read NC"></a>read NC</h4><p><code>nc_path = &quot;./air.sfc.1997.nc&quot;</code></p>
<p>读入文件：使用netCDF4的Dataset方法即可读入文件，读入文件后直接输出即可查看文件的结构。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc = Dataset(nc_path)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(nc)</span><br></pre></td></tr></table></figure>

<p>查看文件的变量：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(nc.variables.keys())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> nc.variables.keys():</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>

<p>查看某个变量的信息：</p>
<p><code>print(nc.variables[&#39;air&#39;])</code></p>
<p>查看某个变量的属性：</p>
<p><code>print(nc.variables[&#39;air&#39;].ncattrs())</code></p>
<p>读取数据值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = nc.variables[<span class="string">&#x27;air&#x27;</span>][:]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>









<p>其他文件读写的部分方法见下方链接内的论坛讨论：</p>
<p>微信不能添加外部超链接，请<strong>复制链接</strong>至浏览器食用！</p>
<p>Python读取txt文件并绘制站点降水散点图：(by：平流层的萝卜)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=36334">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=36334</a></p>
<p>Python读取html表格并存为excel：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89647">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89647</a></p>
<p>Python读取Excel数据：(by：weinihou)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=53175">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=53175</a></p>
<p>用Python批处理CSV文件（时间循环）：(by：云知道)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=40741">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=40741</a></p>
<p>使用Python的netCDF4库读取.nc文件 和 创建.nc文件：(by：18393810639)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92817">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92817</a></p>
<p>Python 创建 读写 nc文件 demo：(by：haysen)<br><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=68059">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=68059</a></p>
<p>Python读取nc数据和绘图：(by：平流层的萝卜)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=36324">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=36324</a></p>
<p>气象可视化NC数据读取及显示效果：(by：wangyongtao0929)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=96555">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=96555</a></p>
<p>Python处理ncep2.5°格点的nc数据，并批量出图到指定文件夹：(by：zhangxk14)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92011">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92011</a></p>
<p>读写nc数据的方法（转载）：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=22726">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=22726</a></p>
<p>windows下如何用xarray+cfgrib读取grib资料：(by：Eegle)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95915">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95915</a></p>
<p>windows下如何将grib2文件转成nc文件：(by：Eegle)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=93383">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=93383</a></p>
<p>使用Python读取GRIB文件：(by：ztftom)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=6370">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=6370</a></p>
<p>Python读取micaps mdfs数据：(by：eeeee)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=87865">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=87865</a></p>
<p>Python 读取micaps第14类数据，并用Basemap进行绘图：(by：18393810639)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90319">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90319</a></p>
<p>风云4号AWX数据读取画图：(by：yuyue1314)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89296">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89296</a></p>
<p>Python FY2E卫星HDF5格式的TBB数据画图：(by：chiqu296)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=56315">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=56315</a></p>
<p>使用Python批量读取hdf5文件：(by：cwllsss)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95187">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95187</a></p>
<p>使用Python 的h5py 和netCDF4读取和创建.nc和.hdf文件：(by：18393810639)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=93873">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=93873</a></p>
<p>重磅更新！读取CINRAD雷达基数据的Python模块：(by：高空急流)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=66878">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=66878</a></p>
<p>Python读取CMA SA雷达基数据文件及绘图&amp;&amp;叠加自动站风场数据：(by：张__QI)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=39225">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=39225</a></p>
<p>Python读取全国自动站CMORPH数据并画图：(by：Masterpiece)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90192">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90192</a></p>
<p>Python+CDO批处理CMIP5模式数据 插值：(by：JOJOweibo)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=52929">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=52929</a></p>
<p>贡献一个读swan产品（bin.bz2格式）的函数：(by：schliezer)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92567">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=92567</a></p>
<p>基于Siphon和MetPy获取探空数据并绘图：(by：hzwjy)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89894">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89894</a></p>
<p>Python处理探空：(by：lovechang1314)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=52208">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=52208</a></p>
<p>基于GSI读取bufr文件：(by：张__QI)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=39619">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=39619</a></p>
<p>Python 读取 Himawari binary 格式文件：(by：张__QI)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=46882">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=46882</a></p>
<p>推广一个非常实用的Python3的CIMISS库：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95632">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95632</a></p>
<p>我的Python学习历程（一、数据读取与存储）：(by：阿阿飞飞)</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=19100">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=19100</a></p>
<p>[求助] Python读取.AWX文件：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=88179">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=88179</a></p>
<p>[求助] Python读取grads格式的ctl和dat格式的数据：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=57801">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=57801</a></p>
<p>[求助] Python如何读取Micaps第四类数据：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95992">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95992</a></p>
<p>[求助] Windows下如何用Python读取、处理Grib2格式数据：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95883">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95883</a></p>
<p>[求助] 如何用Python自动读入NCEP数据的时间：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=34892">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=34892</a></p>
<p>[求助] Python 读取特定格式TXT文本：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=94981">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=94981</a></p>
<p>[求助] 关于读取nc文件结果不完全显示的问题：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95557">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=95557</a></p>
<p>[求助] Python处理Himawari-8 L1级数据：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89522">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=89522</a></p>
<p>[求助]读取雷达数据文件时报错：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90281">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90281</a></p>
<p>[求助] 风云卫星FullMask_Grid.raw文件如何读取：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90074">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90074</a></p>
<p>[求助] 怎么样读取一个月的数据画图？：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90024">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=90024</a></p>
<p>[求助] 求助读取nc文件：</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=88882">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=88882</a></p>
<p>[求助] Python 读取ECMWF ERA_interim 数据时间的问题</p>
<p><a target="_blank" rel="noopener" href="http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=46154">http://bbs.06climate.com/forum.php?mod=viewthread&amp;tid=46154</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/01/Tools/WRF_run_with_CFS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruyan">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruyanc">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/01/Tools/WRF_run_with_CFS/" class="post-title-link" itemprop="url">RUN WRF</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-01 12:00:00" itemprop="dateCreated datePublished" datetime="2022-05-01T12:00:00+08:00">2022-05-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-23 12:00:00" itemprop="dateModified" datetime="2022-05-23T12:00:00+08:00">2022-05-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">-Tools</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="数据介绍："><a href="#数据介绍：" class="headerlink" title="数据介绍："></a>数据介绍：</h5><p>Saha, S., Moorthi, S., Wu, X., et al. (2014). The NCEP climate forecast system version 2. Journal of Climate, 27(6), 2185–2208. <a target="_blank" rel="noopener" href="https://doi.org/10.1175/JCLI-D-12-00823.1">https://doi.org/10.1175/JCLI-D-12-00823.1</a></p>
<p>实时预报数据下载地址：</p>
<p><a target="_blank" rel="noopener" href="https://nomads.ncep.noaa.gov/pub/data/nccf/com/cfs/prod/cfs/">https://nomads.ncep.noaa.gov/pub/data/nccf/com/cfs/prod/cfs/</a></p>
<p>历史预报数据下载地址：</p>
<p><a target="_blank" rel="noopener" href="https://www.ncei.noaa.gov/data/climate-forecast-system/access/operational-9-month-forecast/">https://www.ncei.noaa.gov/data/climate-forecast-system/access/operational-9-month-forecast/</a></p>
<p>数据下载脚本：</p>
<p>In [1]:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"># @ 气象备忘录</span><br><span class="line"># @ meteo_notebook@163.com</span><br><span class="line"></span><br><span class="line">import os,sys</span><br><span class="line">from datetime import datetime,timedelta</span><br><span class="line">import bisect</span><br><span class="line">import pandas as pd </span><br><span class="line"></span><br><span class="line">def str2time(timestr, format = &quot;%Y%m%d%H&quot;):</span><br><span class="line">    return datetime.strptime(timestr, format)</span><br><span class="line"></span><br><span class="line">def time2str(time, format = &quot;%Y%m%d%H&quot;):</span><br><span class="line">    return datetime.strftime(time, format)</span><br><span class="line"></span><br><span class="line">def download_cfs():</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    下载实时预报数据</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    dt_init  = str2time(init)</span><br><span class="line">    </span><br><span class="line">    HH       = time2str(dt_init, &quot;%H&quot;)</span><br><span class="line">    YYYY     = time2str(dt_init, &quot;%Y&quot;)</span><br><span class="line">    YYYYMM   = time2str(dt_init, &quot;%Y%m&quot;)</span><br><span class="line">    YYYYMMDD = time2str(dt_init, &quot;%Y%m%d&quot;)</span><br><span class="line">    </span><br><span class="line">    url_root = &quot;https://nomads.ncep.noaa.gov/pub/data/nccf/com/cfs/prod/cfs&quot;</span><br><span class="line">    url      = f&quot;&#123;url_root&#125;/cfs.&#123;YYYYMMDD&#125;/&#123;HH&#125;/6hrly_grib_01&quot;</span><br><span class="line">    </span><br><span class="line">    valid = time2str(dt_valid)</span><br><span class="line">    # 等压面数据</span><br><span class="line">    os.system(f&quot;axel &#123;url&#125;/pgbf&#123;valid&#125;.01.&#123;init&#125;.grb2&quot;)</span><br><span class="line">    # 地表数据</span><br><span class="line">    os.system(f&quot;axel &#123;url&#125;/flxf&#123;valid&#125;.01.&#123;init&#125;.grb2&quot;)</span><br><span class="line">    </span><br><span class="line">def download_cfs_his():</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    下载历史数据</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    dt_init  = str2time(init)</span><br><span class="line">    YYYY     = dt_init.strftime(&quot;%Y&quot;)</span><br><span class="line">    YYYYMM   = dt_init.strftime(&quot;%Y%m&quot;)</span><br><span class="line">    YYYYMMDD = dt_init.strftime(&quot;%Y%m%d&quot;)</span><br><span class="line">    </span><br><span class="line">    url_root = &quot;https://www.ncei.noaa.gov/data/climate-forecast-system/access/operational-9-month-forecast&quot;</span><br><span class="line">    url_pres = f&quot;&#123;url_root&#125;/6-hourly-by-pressure/&#123;YYYY&#125;/&#123;YYYYMM&#125;/&#123;YYYYMMDD&#125;/&#123;init&#125;&quot;</span><br><span class="line">    url_sfc  = f&quot;&#123;url_root&#125;/6-hourly-flux/&#123;YYYY&#125;/&#123;YYYYMM&#125;/&#123;YYYYMMDD&#125;/&#123;init&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    valid = time2str(dt_valid)</span><br><span class="line">    # 等压面数据</span><br><span class="line">    os.system(f&quot;axel &#123;url_pres&#125;/pgbf&#123;valid&#125;.01.&#123;init&#125;.grb2&quot;)</span><br><span class="line">    # 地表数据</span><br><span class="line">    os.system(f&quot;axel &#123;url_sfc&#125;/flxf&#123;valid&#125;.01.&#123;init&#125;.grb2&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    </span><br><span class="line">    init  = &quot;2022040600&quot;  # 模式起报时间</span><br><span class="line">    </span><br><span class="line">    # 预报时段很长，仅下载其中的一部分</span><br><span class="line">    start = &quot;2022040600&quot;  # 下载数据开始时间</span><br><span class="line">    end   = &quot;2022040700&quot;  # 下载数据结束时间</span><br><span class="line"></span><br><span class="line">    # 下载目录设置</span><br><span class="line">    wrk_dir = f&quot;/home/data/cfs/&#123;init&#125;&quot;</span><br><span class="line">    if not os.path.exists(wrk_dir): os.makedirs(wrk_dir)</span><br><span class="line">    os.chdir(wrk_dir)</span><br><span class="line"></span><br><span class="line">    idx = pd.date_range(str2time(start), str2time(end), freq=&#x27;6H&#x27;)</span><br><span class="line">    for dt_valid in idx:</span><br><span class="line">        print(dt_valid)</span><br><span class="line">        download_cfs()</span><br><span class="line">2022-04-06 00:00:00</span><br><span class="line">2022-04-06 06:00:00</span><br><span class="line">2022-04-06 12:00:00</span><br><span class="line">2022-04-06 18:00:00</span><br><span class="line">2022-04-07 00:00:00</span><br></pre></td></tr></table></figure>

<p>驱动WRF</p>
<p>In [ ]:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -sf ungrib/Variable_Tables/Vtable.CFSR Vtable</span><br><span class="line">./link_grib.csh $&#123;DATA_PATH&#125;/*  # 可以同时链接等压面和地表数据</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ruyan</p>
  <div class="site-description" itemprop="description">Personal Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ruyan</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
