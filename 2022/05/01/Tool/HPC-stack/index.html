<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/Egg_32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/Egg_16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="HPC-stack 安装手册参考： https:&#x2F;&#x2F;github.com&#x2F;comgsi&#x2F;documents https:&#x2F;&#x2F;hpc-stack.readthedocs.io&#x2F;en&#x2F;latest&#x2F; https:&#x2F;&#x2F;hpc-stack.readthedocs.io&#x2F;en&#x2F;latest&#x2F;hpc-install.html pre-requirements: Lmod1234sudo apt-get ins">
<meta property="og:type" content="article">
<meta property="og:title" content="HPC-stack">
<meta property="og:url" content="http://example.com/2022/05/01/Tool/HPC-stack/index.html">
<meta property="og:site_name" content="ruyanc">
<meta property="og:description" content="HPC-stack 安装手册参考： https:&#x2F;&#x2F;github.com&#x2F;comgsi&#x2F;documents https:&#x2F;&#x2F;hpc-stack.readthedocs.io&#x2F;en&#x2F;latest&#x2F; https:&#x2F;&#x2F;hpc-stack.readthedocs.io&#x2F;en&#x2F;latest&#x2F;hpc-install.html pre-requirements: Lmod1234sudo apt-get ins">
<meta property="og:locale">
<meta property="article:published_time" content="2022-05-01T04:00:00.000Z">
<meta property="article:modified_time" content="2024-11-18T02:01:01.870Z">
<meta property="article:author" content="ruyanc">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2022/05/01/Tool/HPC-stack/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>HPC-stack | ruyanc</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ruyanc</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Acedemic Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-atmsci">

    <a href="/categories/AtmSci/" rel="section"><i class="fa fa-graduation-cap fa-fw"></i>AtmSci</a>

  </li>
        <li class="menu-item menu-item-ocnsci">

    <a href="/categories/OcnSci/" rel="section"><i class="fa fa-graduation-cap fa-fw"></i>OcnSci</a>

  </li>
        <li class="menu-item menu-item-seminar">

    <a href="/categories/Seminar/" rel="section"><i class="fa fa-users fa-fw"></i>Seminar</a>

  </li>
        <li class="menu-item menu-item-readcube">

    <a href="/categories/ReadCube/" rel="section"><i class="fa fa-archive fa-fw"></i>ReadCube</a>

  </li>
        <li class="menu-item menu-item-publication">

    <a href="/categories/Publication" rel="section"><i class="fa fa-archive fa-fw"></i>Publication</a>

  </li>
        <li class="menu-item menu-item-recharge">

    <a href="/categories/Recharge/" rel="section"><i class="fa fa-coffee fa-fw"></i>Recharge</a>

  </li>
        <li class="menu-item menu-item-tool">

    <a href="/categories/Tool/" rel="section"><i class="fa fa-wrench fa-fw"></i>Tool</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/01/Tool/HPC-stack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="ruyanc">
      <meta itemprop="description" content="E-mail: ruyan1810@gmail.com">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruyanc">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HPC-stack
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-01 12:00:00" itemprop="dateCreated datePublished" datetime="2022-05-01T12:00:00+08:00">2022-05-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-11-18 10:01:01" itemprop="dateModified" datetime="2024-11-18T10:01:01+08:00">2024-11-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tool/" itemprop="url" rel="index"><span itemprop="name">Tool</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="HPC-stack-安装手册"><a href="#HPC-stack-安装手册" class="headerlink" title="HPC-stack 安装手册"></a>HPC-stack 安装手册</h2><p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/comgsi/documents">https://github.com/comgsi/documents</a></p>
<p><a target="_blank" rel="noopener" href="https://hpc-stack.readthedocs.io/en/latest/">https://hpc-stack.readthedocs.io/en/latest/</a></p>
<p><a target="_blank" rel="noopener" href="https://hpc-stack.readthedocs.io/en/latest/hpc-install.html">https://hpc-stack.readthedocs.io/en/latest/hpc-install.html</a></p>
<h3 id="pre-requirements-Lmod"><a href="#pre-requirements-Lmod" class="headerlink" title="pre-requirements: Lmod"></a>pre-requirements: Lmod</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install lua5.3 liblua5.3-0 liblua5.3-dev lua-filesystem-dev lua-posix-dev</span><br><span class="line">sudo apt-get install tcl tcl8.6-dev libtcl8.6</span><br><span class="line">which lua</span><br><span class="line">which luac</span><br></pre></td></tr></table></figure>

<p>download tar.bz2 file from: <a target="_blank" rel="noopener" href="https://sourceforge.net/projects/lmod/files/">https://sourceforge.net/projects/lmod/files/</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -jxvf Lmod-8.7.tar.bz2</span><br><span class="line">./configure --with-lua=/usr/bin/lua  --with-luac=/usr/bin/luac --prefix=$&#123;HOME&#125;/software</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>Add the following to ~&#x2F;.bashrc</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export BASH_ENV=$HOME/software/lmod/lmod/init/profile</span><br><span class="line">source $BASH_ENV</span><br></pre></td></tr></table></figure>



<h3 id="Out-of-container"><a href="#Out-of-container" class="headerlink" title="Out of container"></a>Out of container</h3><p>Please refer to <a target="_blank" rel="noopener" href="https://hpc-stack.readthedocs.io/en/latest/hpc-install.html">https://hpc-stack.readthedocs.io/en/latest/hpc-install.html</a> first</p>
<p>Some additional tips are:</p>
<ul>
<li>查看编译器版本</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">more /proc/version</span><br><span class="line">ompi_info</span><br><span class="line">python --version</span><br></pre></td></tr></table></figure>

<ul>
<li><code>vi config_custom.sh</code> 对应修改</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./setup_modules.sh -p /home/ruyanc/WORK/hpc-stack -c  config/config_custom.sh</span><br></pre></td></tr></table></figure>

<ul>
<li>更新CMAKE：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/519732843">https://zhuanlan.zhihu.com/p/519732843</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./build_stack.sh -p /home/ruyanc/WORK/hpc-stack -c config/config_custom.sh -y stack/stack_custom.yaml -m</span><br></pre></td></tr></table></figure>

<ul>
<li>只编译其中一个库</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./build_stack.sh -p /home/ruyanc/WORK/hpc-stack -c config/config_custom.sh -y stack/stack_custom.yaml -m -l netcdf</span><br></pre></td></tr></table></figure>





<h4 id="DEBUG-pio-安装出错"><a href="#DEBUG-pio-安装出错" class="headerlink" title="DEBUG: pio 安装出错"></a>DEBUG: pio 安装出错</h4><p><strong>解决方式：</strong> 修改<code>/work/home/acyii6v8kt/hpc-stack/pkg/pio-2.5.10/scripts/genf90.pl</code>中第一行为<code>my @types = qw(text real double int short);</code></p>
<h4 id="DUBUG：网络不好，无法下载安装文件"><a href="#DUBUG：网络不好，无法下载安装文件" class="headerlink" title="DUBUG：网络不好，无法下载安装文件"></a>DUBUG：网络不好，无法下载安装文件</h4><p><strong>解决方式：</strong> 外部下载后上传到<code>hpc-stack/pkg</code>下</p>
<hr>
<h3 id="Another-Choice-Inside-a-container-Singularity"><a href="#Another-Choice-Inside-a-container-Singularity" class="headerlink" title="Another Choice:  Inside a container - Singularity"></a>Another Choice:  Inside a container - Singularity</h3><p><a target="_blank" rel="noopener" href="https://docs.sylabs.io/guides/3.2/user-guide/installation.html">https://docs.sylabs.io/guides/3.2/user-guide/installation.html</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get update &amp;&amp; sudo apt-get install -y \</span></span><br><span class="line"><span class="language-bash">    build-essential \</span></span><br><span class="line"><span class="language-bash">    libssl-dev \</span></span><br><span class="line"><span class="language-bash">    uuid-dev \</span></span><br><span class="line"><span class="language-bash">    libgpgme11-dev \</span></span><br><span class="line"><span class="language-bash">    squashfs-tools \</span></span><br><span class="line"><span class="language-bash">    libseccomp-dev \</span></span><br><span class="line"><span class="language-bash">    wget \</span></span><br><span class="line"><span class="language-bash">    pkg-config \</span></span><br><span class="line"><span class="language-bash">    git</span></span><br></pre></td></tr></table></figure>

<ul>
<li>install go</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> VERSION=1.20 OS=linux ARCH=amd64 &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    wget https://dl.google.com/go/go<span class="variable">$VERSION</span>.<span class="variable">$OS</span>-<span class="variable">$ARCH</span>.tar.gz &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    sudo tar -C /usr/local -xzvf go<span class="variable">$VERSION</span>.<span class="variable">$OS</span>-<span class="variable">$ARCH</span>.tar.gz &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">rm</span> go<span class="variable">$VERSION</span>.<span class="variable">$OS</span>-<span class="variable">$ARCH</span>.tar.gz</span></span><br><span class="line">    </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&#x27;export GOPATH=$&#123;HOME&#125;/go&#x27;</span> &gt;&gt; ~/.bashrc &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;export PATH=/usr/local/go/bin:$&#123;PATH&#125;:$&#123;GOPATH&#125;/bin&#x27;</span> &gt;&gt; ~/.bashrc &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">source</span> ~/.bashrc</span></span><br></pre></td></tr></table></figure>

<ul>
<li>install singularity</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> VERSION=4.1.1 &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    wget https://github.com/sylabs/singularity/releases/download/v4.1.1/singularity-ce-4.1.1.tar.gz &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    tar -xzf singularity-<span class="variable">$&#123;VERSION&#125;</span>.tar.gz &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">cd</span> singularity</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Check the latest release here: https://github.com/sylabs/singularity/releases</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># also pay attention to the dir loc</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>add pre-requirements</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get install libglib2.0-dev</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get install libfuse-dev</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get install fuse</span></span><br></pre></td></tr></table></figure>

<ul>
<li>install sinularity</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./mconfig &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    make -C ./builddir &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    sudo make -C ./builddir install</span></span><br><span class="line">    </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./mconfig --prefix=/opt/singularity</span></span><br></pre></td></tr></table></figure>

<ul>
<li>test installation</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">singularity --version</span></span><br></pre></td></tr></table></figure>





<h4 id="Build-and-Run-the-Container"><a href="#Build-and-Run-the-Container" class="headerlink" title="Build and Run the Container"></a>Build and Run the Container</h4><ul>
<li>Pull and build the container</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">singularity pull ubuntu20.04-gnu9.3.sif docker://noaaepic/ubuntu20.04-gnu9.3</span><br><span class="line">singularity build --sandbox ubuntu20.04-gnu9.3 ubuntu20.04-gnu9.3.sif</span><br><span class="line">cd ubuntu20.04-gnu9.3</span><br></pre></td></tr></table></figure>

<ul>
<li>Make a directory (e.g., <code>contrib</code>) in the container if one does not exist:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir contrib</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure>

<ul>
<li>From the local working directory, start the container and run an interactive shell within it. This command also binds the local working directory to the container so that data can be shared between them.</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">singularity shell -e --writable --bind /&lt;local_dir&gt;:/contrib ubuntu20.04-gnu9.3</span><br></pre></td></tr></table></figure>



<h4 id="Build-the-HPC-Stack"><a href="#Build-the-HPC-Stack" class="headerlink" title="Build the HPC-Stack"></a>Build the HPC-Stack</h4><ul>
<li>Clone the HPC-Stack repository (from inside the Singularity shell initialized above).</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/NOAA-EMC/hpc-stack</span><br><span class="line">cd hpc-stack</span><br></pre></td></tr></table></figure>

<ul>
<li>Set up the build environment.</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./setup_modules.sh -p /home/ruyanc/WORK/hpc-stack -c config/config_custom.sh</span><br></pre></td></tr></table></figure>

<ul>
<li>Enter YES&#x2F;YES&#x2F;YES when the option is presented. Then modify <code>build_stack.sh</code> with the following commands:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -i &quot;10 a source /usr/share/lmod/6.6/init/bash&quot; ./build_stack.sh</span><br><span class="line">sed -i &quot;10 a export PATH=/usr/local/sbin:/usr/local/bin:$PATH&quot; ./build_stack.sh</span><br><span class="line">sed -i &quot;10 a export LD_LIBRARY_PATH=/usr/local/lib64:/usr/local/lib:$LD_LIBRARY_PATH&quot; ./build_stack.sh</span><br></pre></td></tr></table></figure>

<ul>
<li>Build the environment. This may take up to a couple of hours to complete.</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./build_stack.sh -p /home/ruyanc/WORK/hpc-stack -c config/config_custom.sh -y stack/stack_custom.yaml -m</span><br></pre></td></tr></table></figure>

<ul>
<li>Load the required modules, making sure to change the <code>&lt;prefix&gt;</code> to the location of the module files.</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source /usr/share/lmod/lmod/init/bash</span><br><span class="line">module use &lt;prefix&gt;/hpc-modules/modulefiles/stack</span><br><span class="line">module load hpc hpc-gnu hpc-openmpi</span><br><span class="line">module avail</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/01/Tool/GitHub/" rel="prev" title="Github">
      <i class="fa fa-chevron-left"></i> Github
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/01/Tool/GCC/" rel="next" title="GCC">
      GCC <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#HPC-stack-%E5%AE%89%E8%A3%85%E6%89%8B%E5%86%8C"><span class="nav-number">1.</span> <span class="nav-text">HPC-stack 安装手册</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pre-requirements-Lmod"><span class="nav-number">1.1.</span> <span class="nav-text">pre-requirements: Lmod</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Out-of-container"><span class="nav-number">1.2.</span> <span class="nav-text">Out of container</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DEBUG-pio-%E5%AE%89%E8%A3%85%E5%87%BA%E9%94%99"><span class="nav-number">1.2.1.</span> <span class="nav-text">DEBUG: pio 安装出错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DUBUG%EF%BC%9A%E7%BD%91%E7%BB%9C%E4%B8%8D%E5%A5%BD%EF%BC%8C%E6%97%A0%E6%B3%95%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.2.</span> <span class="nav-text">DUBUG：网络不好，无法下载安装文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Another-Choice-Inside-a-container-Singularity"><span class="nav-number">1.3.</span> <span class="nav-text">Another Choice:  Inside a container - Singularity</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Build-and-Run-the-Container"><span class="nav-number">1.3.1.</span> <span class="nav-text">Build and Run the Container</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Build-the-HPC-Stack"><span class="nav-number">1.3.2.</span> <span class="nav-text">Build the HPC-Stack</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ruyanc"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">ruyanc</p>
  <div class="site-description" itemprop="description">E-mail: ruyan1810@gmail.com</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">210</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>




      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ruyanc</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.3" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true,"scale":0.5},"log":false});</script></body>
</html>

